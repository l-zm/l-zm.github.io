{"title":"Linux GNU Grep 查询日志","date":"2022-01-24T00:00:00.000Z","date_formatted":{"ll":"2022年1月24日","L":"2022/01/24","MM-DD":"01-24"},"thumbnail":"https://pic.imgdb.cn/item/62d7d311f54cd3f9372775d5.png","link":"linux-select-log","tags":["Linux"],"categories":["Linux"],"updated":"2022-01-23T16:00:00.000Z","content":"<p>官方介绍手册: <code>http://www.gnu.org/software/grep/manual/grep.html</code></p>\n<ul>\n<li>Grep 命令的格式<br>\n<code>grep [option...] [patterns] [file...]</code></li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@coursecenterresource-0 logs]# grep --help</span><br><span class=\"line\">Usage: grep [OPTION]... PATTERN [FILE]...</span><br><span class=\"line\">Search for PATTERN in each FILE or standard input.</span><br><span class=\"line\">PATTERN is, by default, a basic regular expression (BRE).</span><br><span class=\"line\">Example: grep -i &#x27;hello world&#x27; menu.h main.c</span><br><span class=\"line\"></span><br><span class=\"line\">Regexp selection and interpretation:</span><br><span class=\"line\">  -E, --extended-regexp     PATTERN is an extended regular expression (ERE)</span><br><span class=\"line\">  -F, --fixed-strings       PATTERN is a set of newline-separated fixed strings</span><br><span class=\"line\">  -G, --basic-regexp        PATTERN is a basic regular expression (BRE)</span><br><span class=\"line\">  -P, --perl-regexp         PATTERN is a Perl regular expression</span><br><span class=\"line\">  -e, --regexp=PATTERN      use PATTERN for matching</span><br><span class=\"line\">  -f, --file=FILE           obtain PATTERN from FILE</span><br><span class=\"line\">  -i, --ignore-case         ignore case distinctions</span><br><span class=\"line\">  -w, --word-regexp         force PATTERN to match only whole words</span><br><span class=\"line\">  -x, --line-regexp         force PATTERN to match only whole lines</span><br><span class=\"line\">  -z, --null-data           a data line ends in 0 byte, not newline</span><br><span class=\"line\"></span><br><span class=\"line\">Miscellaneous:</span><br><span class=\"line\">  -s, --no-messages         suppress error messages</span><br><span class=\"line\">  -v, --invert-match        select non-matching lines</span><br><span class=\"line\">  -V, --version             display version information and exit</span><br><span class=\"line\">      --help                display this help text and exit</span><br><span class=\"line\"></span><br><span class=\"line\">Output control:</span><br><span class=\"line\">  -m, --max-count=NUM       stop after NUM matches</span><br><span class=\"line\">  -b, --byte-offset         print the byte offset with output lines</span><br><span class=\"line\">  -n, --line-number         print line number with output lines</span><br><span class=\"line\">      --line-buffered       flush output on every line</span><br><span class=\"line\">  -H, --with-filename       print the file name for each match</span><br><span class=\"line\">  -h, --no-filename         suppress the file name prefix on output</span><br><span class=\"line\">      --label=LABEL         use LABEL as the standard input file name prefix</span><br><span class=\"line\">  -o, --only-matching       show only the part of a line matching PATTERN</span><br><span class=\"line\">  -q, --quiet, --silent     suppress all normal output</span><br><span class=\"line\">      --binary-files=TYPE   assume that binary files are TYPE;</span><br><span class=\"line\">                            TYPE is &#x27;binary&#x27;, &#x27;text&#x27;, or &#x27;without-match&#x27;</span><br><span class=\"line\">  -a, --text                equivalent to --binary-files=text</span><br><span class=\"line\">  -I                        equivalent to --binary-files=without-match</span><br><span class=\"line\">  -d, --directories=ACTION  how to handle directories;</span><br><span class=\"line\">                            ACTION is &#x27;read&#x27;, &#x27;recurse&#x27;, or &#x27;skip&#x27;</span><br><span class=\"line\">  -D, --devices=ACTION      how to handle devices, FIFOs and sockets;</span><br><span class=\"line\">                            ACTION is &#x27;read&#x27; or &#x27;skip&#x27;</span><br><span class=\"line\">  -r, --recursive           like --directories=recurse</span><br><span class=\"line\">  -R, --dereference-recursive</span><br><span class=\"line\">                            likewise, but follow all symlinks</span><br><span class=\"line\">      --include=FILE_PATTERN</span><br><span class=\"line\">                            search only files that match FILE_PATTERN</span><br><span class=\"line\">      --exclude=FILE_PATTERN</span><br><span class=\"line\">                            skip files and directories matching FILE_PATTERN</span><br><span class=\"line\">      --exclude-from=FILE   skip files matching any file pattern from FILE</span><br><span class=\"line\">      --exclude-dir=PATTERN directories that match PATTERN will be skipped.</span><br><span class=\"line\">  -L, --files-without-match print only names of FILEs containing no match</span><br><span class=\"line\">  -l, --files-with-matches  print only names of FILEs containing matches</span><br><span class=\"line\">  -c, --count               print only a count of matching lines per FILE</span><br><span class=\"line\">  -T, --initial-tab         make tabs line up (if needed)</span><br><span class=\"line\">  -Z, --null                print 0 byte after FILE name</span><br><span class=\"line\"></span><br><span class=\"line\">Context control:</span><br><span class=\"line\">  -B, --before-context=NUM  print NUM lines of leading context</span><br><span class=\"line\">  -A, --after-context=NUM   print NUM lines of trailing context</span><br><span class=\"line\">  -C, --context=NUM         print NUM lines of output context</span><br><span class=\"line\">  -NUM                      same as --context=NUM</span><br><span class=\"line\">      --group-separator=SEP use SEP as a group separator</span><br><span class=\"line\">      --no-group-separator  use empty string as a group separator</span><br><span class=\"line\">      --color[=WHEN],</span><br><span class=\"line\">      --colour[=WHEN]       use markers to highlight the matching strings;</span><br><span class=\"line\">                            WHEN is &#x27;always&#x27;, &#x27;never&#x27;, or &#x27;auto&#x27;</span><br><span class=\"line\">  -U, --binary              do not strip CR characters at EOL (MSDOS/Windows)</span><br><span class=\"line\">  -u, --unix-byte-offsets   report offsets as if CRs were not there</span><br><span class=\"line\">                            (MSDOS/Windows)</span><br><span class=\"line\"></span><br><span class=\"line\">&#x27;egrep&#x27; means &#x27;grep -E&#x27;.  &#x27;fgrep&#x27; means &#x27;grep -F&#x27;.</span><br><span class=\"line\">Direct invocation as either &#x27;egrep&#x27; or &#x27;fgrep&#x27; is deprecated.</span><br><span class=\"line\">When FILE is -, read standard input.  With no FILE, read . if a command-line</span><br><span class=\"line\">-r is given, - otherwise.  If fewer than two FILEs are given, assume -h.</span><br><span class=\"line\">Exit status is 0 if any line is selected, 1 otherwise;</span><br><span class=\"line\">if any error occurs and -q is not given, the exit status is 2.</span><br><span class=\"line\"></span><br><span class=\"line\">Report bugs to: bug-grep@gnu.org</span><br><span class=\"line\">GNU Grep home page: &lt;http://www.gnu.org/software/grep/&gt;</span><br><span class=\"line\">General help using GNU software: &lt;http://www.gnu.org/gethelp/&gt;</span><br></pre></td></tr></table></figure>\n<figure class=\"highlight sh\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># 查询 info.log 日志文件中包含【关键字】的行</span></span><br><span class=\"line\">grep 关键字 /data/info.log</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"built_in\">cat</span> /data/info.log | grep <span class=\"string\">&#x27;关键字&#x27;</span></span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 反向查找 不包换关键字的行</span></span><br><span class=\"line\">grep -v 关键字 /data/info.log</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 不区分大小写</span></span><br><span class=\"line\">grep -i <span class=\"string\">&#x27;l-zm&#x27;</span> /data/info.log</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 输出匹配的行数</span></span><br><span class=\"line\">grep -c <span class=\"string\">&#x27;l-zm&#x27;</span> /data/info.log</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 只输出匹配的内容</span></span><br><span class=\"line\">grep -o <span class=\"string\">&#x27;l-zm&#x27;</span> /data/info.log</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># 输出 带行号</span></span><br><span class=\"line\">grep -n <span class=\"string\">&#x27;l-zm&#x27;</span> /data/info.log</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\"># -A:after 匹配行及之后5行的内容</span></span><br><span class=\"line\"><span class=\"comment\"># -B:before 匹配行及之前5行的内容</span></span><br><span class=\"line\"><span class=\"comment\"># -C:context 匹配行及前后5行的内容</span></span><br><span class=\"line\">grep -A 5 <span class=\"string\">&#x27;关键字&#x27;</span> /data/info.log</span><br><span class=\"line\">grep -B 5 <span class=\"string\">&#x27;关键字&#x27;</span> /data/info.log</span><br><span class=\"line\">grep -C 5 <span class=\"string\">&#x27;关键字&#x27;</span> /data/info.log</span><br></pre></td></tr></table></figure>\n<p>查询最后 1 次出现的日志<br>\n<code>grep -n '关键字' info.log | head -1</code></p>\n<p>查询最后 5 次出现的日志<br>\n<code>grep -n '关键字' info.log | head -5</code></p>\n<p>查询最开始 1 次出现的日志<br>\n<code>grep -n '关键字' info.log | tail -1</code></p>\n<h3 id=\"正则\">正则<a title=\"#正则\" href=\"#正则\"></a></h3>\n<ul>\n<li>\n<p>以 关键字 开头<br>\n<code>grep '^关键字' /data/info.log</code></p>\n</li>\n<li>\n<p>以 关键字 结尾<br>\n<code>grep '关键字$' /data/info.log</code></p>\n</li>\n<li>\n<p>以多个 关键字 开头<br>\n<code>grep '^[关键字关键字]' /data/info.log</code><br>\n<code>grep '^关键字|^关键字' /data/info.log</code></p>\n</li>\n</ul>\n","prev":{"title":"Windows & Mac M3U8 视频下载","link":"m3u8-download"},"next":{"title":"IP地址 归属地查询工具","link":"java-ip"},"plink":"http://l-zm.com/linux-select-log/","toc":[{"id":"正则","title":"正则","index":"1"}],"reading_time":"1021 字约 7 分钟"}